{
  "CORE_LAWS": [
    "Update brain.json every 5 MIN during builds",
    "NEVER lose progress"
  ],
  "lastUpdated": "2026-01-23T11:00:00Z",
  "currentSession": "SESSION-54-BULLETPROOF-MEDIA",
  
  "status": "âœ… CORE SYSTEM BUILT - Ready for testing",
  
  "architecture": {
    "summary": "Offline-first media capture - photos save locally first, sync in background",
    "keyPrinciple": "NEVER lose a photo",
    "tables": {
      "PRIMARY": "montree_media",
      "LEGACY": "child_work_media (fixed)"
    }
  },
  
  "filesCreated": [
    "/lib/media/types.ts",
    "/lib/media/db.ts",
    "/lib/media/sync.ts",
    "/lib/media/capture.ts",
    "/lib/media/useMedia.ts",
    "/lib/media/index.ts",
    "/components/media/QuickCapture.tsx",
    "/components/media/SyncStatus.tsx",
    "/migrations/064_unified_media_system.sql"
  ],
  
  "filesModified": [
    "/app/montree/dashboard/page.tsx",
    "/app/api/montree/media/upload/route.ts"
  ],
  
  "actionRequired": [
    "1. Run SQL in Supabase: migrations/064_unified_media_system.sql",
    "2. Ensure whale-media bucket exists in Supabase Storage",
    "3. Deploy: git push",
    "4. Test Quick Capture on phone"
  ],
  
  "captureFlow": [
    "User taps Quick Snap",
    "Camera opens instantly",
    "Tap to capture photo",
    "Select child from grid",
    "Photo saved to IndexedDB INSTANTLY",
    "Toast shows success immediately",
    "Background sync uploads to Supabase",
    "If offline - photo queued for later",
    "Retry up to 5x with exponential backoff"
  ]
}
