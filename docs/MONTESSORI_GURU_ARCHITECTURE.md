# Montessori Guru Architecture

## Philosophy: Complexity Absorbed, Simplicity Delivered

Like a master watchmaker's creation - thousands of intricate parts working in perfect harmony, yet the user simply reads the time.

---

## The Surface (What Teachers See)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ§’ Rachel Martinez (Age 4y 7m)                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                â”‚
â”‚  "Rachel can't seem to focus lately. She wanders around        â”‚
â”‚   the classroom and won't settle into work. What should I do?" â”‚
â”‚                                                                â”‚
â”‚                                              [Ask Guru] ğŸ”®     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

That's it. A simple question box. Everything else is invisible.

---

## The Depths (What Happens Behind the Scenes)

### Step 1: Context Gathering (0.5 seconds)

When teacher asks about Rachel, we instantly pull:

```
â”Œâ”€ CHILD PROFILE RETRIEVAL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                â”‚
â”‚  BIOGRAPHICAL                                                  â”‚
â”‚  â”œâ”€ Age: 4 years 7 months                                     â”‚
â”‚  â”œâ”€ Time at school: 8 months                                  â”‚
â”‚  â””â”€ Family context: New sibling born 3 weeks ago              â”‚
â”‚                                                                â”‚
â”‚  SENSITIVE PERIODS (Active)                                   â”‚
â”‚  â”œâ”€ Order (waning but present)                                â”‚
â”‚  â”œâ”€ Language (peak - vocabulary explosion)                    â”‚
â”‚  â””â”€ Movement refinement (strong)                              â”‚
â”‚                                                                â”‚
â”‚  EXECUTIVE FUNCTION STAGE                                     â”‚
â”‚  â”œâ”€ Working memory: 1.5 units (age-appropriate)               â”‚
â”‚  â”œâ”€ Inhibition: Developing (struggles with impulse control)   â”‚
â”‚  â””â”€ Task switching: Age-appropriate                           â”‚
â”‚                                                                â”‚
â”‚  TEMPERAMENT PROFILE                                          â”‚
â”‚  â”œâ”€ Activity Level: High                                      â”‚
â”‚  â”œâ”€ Initial Reaction: Approach (curious)                      â”‚
â”‚  â”œâ”€ Persistence: Moderate                                     â”‚
â”‚  â”œâ”€ Distractibility: High                                     â”‚
â”‚  â””â”€ Sensory Threshold: Low (sensitive)                        â”‚
â”‚                                                                â”‚
â”‚  LEARNING PATTERNS                                            â”‚
â”‚  â”œâ”€ Best focus: Morning (9-10am)                              â”‚
â”‚  â”œâ”€ Modality: Kinesthetic/tactile primary                     â”‚
â”‚  â”œâ”€ Baseline focus duration: 8-12 minutes                     â”‚
â”‚  â””â”€ Current focus duration: 2-3 minutes (below baseline)      â”‚
â”‚                                                                â”‚
â”‚  RECENT OBSERVATIONS (Last 2 weeks)                           â”‚
â”‚  â”œâ”€ "Wandering more than usual" - Jan 28                      â”‚
â”‚  â”œâ”€ "Started Practical Life, left after 2 min" - Jan 27       â”‚
â”‚  â”œâ”€ "Asked about baby 3x today" - Jan 26                      â”‚
â”‚  â””â”€ "Cried at drop-off (unusual)" - Jan 25                    â”‚
â”‚                                                                â”‚
â”‚  CURRENT WORKS                                                 â”‚
â”‚  â”œâ”€ Practical Life: Pouring (practicing, regression noted)    â”‚
â”‚  â”œâ”€ Sensorial: Pink Tower (mastered)                          â”‚
â”‚  â””â”€ Language: Sandpaper Letters S,M,A (presented)             â”‚
â”‚                                                                â”‚
â”‚  WHAT HAS WORKED BEFORE                                       â”‚
â”‚  â”œâ”€ One-on-one presentation time                              â”‚
â”‚  â”œâ”€ Sitting near window (natural light)                       â”‚
â”‚  â””â”€ Having older child as buddy                               â”‚
â”‚                                                                â”‚
â”‚  ENVIRONMENTAL FACTORS                                         â”‚
â”‚  â”œâ”€ New sibling: Born 3 weeks ago                             â”‚
â”‚  â”œâ”€ Sleep: Disrupted (per parent)                             â”‚
â”‚  â””â”€ Classroom: Just rearranged last week                      â”‚
â”‚                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Step 2: Pattern Recognition

The system identifies:
- **Timeline correlation**: Focus issues started ~2 weeks ago = sibling birth
- **Behavioral function**: Wandering = seeking attention/connection, not defiance
- **Regression pattern**: Normal during major life transitions
- **Sensitive period conflict**: Order period + classroom rearrangement + home disruption

### Step 3: Knowledge Base Query

Pull relevant Montessori wisdom:
- Regression during life transitions (Maria Montessori on sensitive period for order)
- Attention-seeking as communication of unmet need
- Movement as self-regulation tool
- Concentration development techniques

### Step 4: Reasoning Chain (Hidden from User)

```
REASONING:
1. Rachel's focus issues correlate precisely with sibling birth (3 weeks ago)
2. Additional stressors: classroom rearrangement disrupted her sense of order
3. Her temperament (high activity, high distractibility) + stress = more obvious symptoms
4. Behavioral function: She's seeking connection/security, not avoiding work
5. Her sensitive period for order is being violated at home AND school
6. She's kinesthetic - needs movement to self-regulate
7. Past success: one-on-one time, buddy system = she needs connection
8. Sleep disruption compounds executive function challenges

CONCLUSION: This is a predictable, temporary regression caused by major life
transition. Address the underlying need (security, order, connection) rather
than the symptom (wandering).
```

### Step 5: Generate Actionable Plan

---

## The Output (What Teacher Receives)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ”® GURU INSIGHT                                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                â”‚
â”‚  Rachel's focus change appears connected to her new sibling   â”‚
â”‚  (born 3 weeks ago) - this is a normal, temporary regression. â”‚
â”‚                                                                â”‚
â”‚  Her wandering is likely seeking connection and security,     â”‚
â”‚  not avoiding work.                                            â”‚
â”‚                                                                â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚  ğŸ“‹ THIS WEEK'S PLAN                                          â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚                                                                â”‚
â”‚  1. MORNING CHECK-IN (5 min)                                  â”‚
â”‚     Greet Rachel at the door. Ask about her baby brother.     â”‚
â”‚     Let her talk. This fills her attention-seeking need       â”‚
â”‚     positively before it manifests as wandering.              â”‚
â”‚                                                                â”‚
â”‚  2. RESTORE ORDER                                              â”‚
â”‚     Her sensitive period for order is stressed. Give her a    â”‚
â”‚     "special job" - arranging the Practical Life shelf each   â”‚
â”‚     morning. This meets her need for order AND connection.    â”‚
â”‚                                                                â”‚
â”‚  3. MOVEMENT BEFORE FOCUS                                      â”‚
â”‚     Before presenting any work, invite her to "walk the line" â”‚
â”‚     for 3 minutes. Her high activity level needs this outlet  â”‚
â”‚     before she can concentrate.                                â”‚
â”‚                                                                â”‚
â”‚  4. WORK BESIDE HER                                            â”‚
â”‚     For this week, do parallel work nearby. Don't direct -    â”‚
â”‚     just be present. She needs proximity security right now.  â”‚
â”‚                                                                â”‚
â”‚  5. BUDDY SYSTEM                                               â”‚
â”‚     Pair her with Maya (who helped her before). Older child   â”‚
â”‚     connection worked well in past.                           â”‚
â”‚                                                                â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚  â° EXPECTED TIMELINE                                          â”‚
â”‚  Focus should improve within 2-3 weeks as she adjusts to      â”‚
â”‚  new sibling. If no improvement by Week 3, let's reassess.    â”‚
â”‚                                                                â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚  ğŸ’¬ PARENT TALKING POINT                                       â”‚
â”‚  "Rachel is adjusting beautifully to being a big sister.      â”‚
â”‚  We're giving her extra connection time at school while       â”‚
â”‚  things settle at home."                                       â”‚
â”‚                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    [âœ“ Log to Rachel's Profile]  [ğŸ“ Add Follow-up Reminder]
```

---

## Database Schema: Child Mental Profile

```sql
-- Core child profile extension
CREATE TABLE child_mental_profiles (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  child_id UUID REFERENCES children(id) ON DELETE CASCADE,

  -- Temperament dimensions (1-5 scale)
  temperament_activity_level INT,        -- Low to High
  temperament_regularity INT,            -- Irregular to Regular
  temperament_initial_reaction INT,      -- Withdrawal to Approach
  temperament_adaptability INT,          -- Slow to Quick
  temperament_intensity INT,             -- Low to High
  temperament_mood_quality INT,          -- Negative to Positive
  temperament_distractibility INT,       -- Low to High
  temperament_persistence INT,           -- Low to High
  temperament_sensory_threshold INT,     -- Low (sensitive) to High

  -- Learning profile
  learning_modality_visual INT,          -- 1-5 preference
  learning_modality_auditory INT,
  learning_modality_kinesthetic INT,
  learning_modality_reading_writing INT,
  baseline_focus_duration_minutes INT,   -- What's normal for THIS child
  optimal_time_of_day TEXT,              -- morning, midday, afternoon

  -- Executive function stage
  working_memory_capacity DECIMAL,       -- Units (age-typical: 1 at 3yo, 2 at 5yo)
  inhibition_stage TEXT,                 -- developing, emerging, established
  task_switching_stage TEXT,
  planning_organization_stage TEXT,

  -- Sensitive periods status (active, waning, complete)
  sensitive_period_order TEXT,
  sensitive_period_language TEXT,
  sensitive_period_movement TEXT,
  sensitive_period_sensory TEXT,
  sensitive_period_small_objects TEXT,
  sensitive_period_grace_courtesy TEXT,
  sensitive_period_writing TEXT,
  sensitive_period_reading TEXT,
  sensitive_period_math TEXT,

  -- Environmental factors (updated regularly)
  family_notes TEXT,                     -- Siblings, changes, stressors
  sleep_status TEXT,                     -- normal, disrupted, unknown
  home_language TEXT,
  special_considerations TEXT,           -- Allergies, medical, sensory needs

  -- What works for this child
  successful_strategies TEXT[],          -- Array of things that work
  challenging_triggers TEXT[],           -- What causes difficulty

  updated_at TIMESTAMP DEFAULT now(),
  updated_by UUID REFERENCES teachers(id)
);

-- Behavioral observations with function analysis
CREATE TABLE behavioral_observations (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  child_id UUID REFERENCES children(id),
  observed_at TIMESTAMP DEFAULT now(),
  observed_by UUID REFERENCES teachers(id),

  -- The behavior
  behavior_description TEXT NOT NULL,

  -- Function analysis (the WHY, not just WHAT)
  antecedent TEXT,                       -- What happened before
  behavior_function TEXT,                -- attention, escape, sensory, tangible
  consequence TEXT,                      -- What happened after

  -- Context
  time_of_day TEXT,
  activity_during TEXT,
  environmental_notes TEXT,

  -- Resolution
  intervention_used TEXT,
  effectiveness TEXT                     -- effective, partially, ineffective
);

-- Guru interaction log
CREATE TABLE guru_interactions (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  child_id UUID REFERENCES children(id),
  teacher_id UUID REFERENCES teachers(id),
  asked_at TIMESTAMP DEFAULT now(),

  -- The query
  teacher_question TEXT NOT NULL,

  -- Context gathered (for debugging/improvement)
  context_snapshot JSONB,                -- All data pulled about child

  -- The response
  guru_response TEXT NOT NULL,
  action_plan JSONB,                     -- Structured action items

  -- Follow-up
  follow_up_date DATE,
  follow_up_notes TEXT,
  outcome TEXT                           -- improved, no change, worsened, ongoing
);

-- Pattern history
CREATE TABLE child_patterns (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  child_id UUID REFERENCES children(id),
  pattern_type TEXT,                     -- focus, social, emotional, learning
  pattern_description TEXT,
  first_observed DATE,
  still_active BOOLEAN DEFAULT true,
  notes TEXT
);
```

---

## API Architecture

```
POST /api/montree/guru

Request:
{
  "child_id": "uuid",
  "question": "Rachel can't focus, what should I do?",
  "teacher_id": "uuid"
}

Behind the scenes:
1. Fetch child mental profile
2. Fetch recent observations (last 30 days)
3. Fetch current works and progress
4. Fetch behavioral observations
5. Fetch past guru interactions (what's been tried)
6. Fetch relevant few-shot examples from knowledge base
7. Construct mega-prompt with all context
8. Call Claude API with reasoning chain
9. Parse response into structured action plan
10. Log interaction to guru_interactions table
11. Update child profile if new insights detected
12. Return clean response to teacher

Response:
{
  "insight": "Rachel's focus change appears connected to...",
  "root_cause": "Life transition (new sibling)",
  "action_plan": [
    {
      "priority": 1,
      "action": "Morning check-in",
      "duration": "5 minutes",
      "details": "Greet Rachel at the door...",
      "rationale": "Fills attention-seeking need positively"
    },
    ...
  ],
  "timeline": "2-3 weeks",
  "follow_up_date": "2024-02-14",
  "parent_talking_point": "Rachel is adjusting beautifully..."
}
```

---

## The Prompt Engineering

The system constructs a prompt like this:

```
You are a master Montessori guide with 30 years of experience. You understand
child development deeply - not just symptoms, but root causes. You think about
the whole child: their temperament, sensitive periods, family context, and
individual patterns.

CHILD PROFILE:
[Full mental profile inserted here]

RECENT OBSERVATIONS:
[Last 30 days of teacher notes]

CURRENT WORKS:
[Progress across all areas]

BEHAVIORAL PATTERNS:
[Any logged behavioral observations with function analysis]

WHAT HAS WORKED BEFORE:
[From successful_strategies array]

WHAT WE'VE ALREADY TRIED:
[From past guru interactions]

---

FEW-SHOT EXAMPLE 1:
Teacher asked: "Marcus keeps hitting other children during circle time."
Context: Marcus (3y 2m), new to school (2 weeks), sensitive period for movement
strong, high activity temperament, escape function identified.

Expert response: "Marcus's hitting appears to be escape-motivated - he's
overwhelmed by the stillness required during circle. His sensitive period for
movement and high activity level make sitting still genuinely difficult, not
defiant. Try: 1) Position him at the edge of circle with movement option,
2) Give him a fidget tool, 3) Shorten his circle time to 5 minutes initially,
4) Have him 'help' by holding materials..."

---

TEACHER'S QUESTION:
"Rachel can't seem to focus lately. She wanders around the classroom and won't
settle into work. What should I do?"

Provide:
1. Your insight into the root cause (not the symptom)
2. A specific, actionable plan for THIS child (not generic advice)
3. Timeline for expected improvement
4. A parent talking point
5. Any follow-up observations to make

Think step by step about what's really happening with this child before
responding.
```

---

## Why This Works

1. **Rich context** = Specific recommendations (not generic "try a fidget toy")
2. **Pattern history** = Don't repeat failed interventions
3. **Function analysis** = Address the WHY, not just the WHAT
4. **Few-shot examples** = Model learns HOW to reason about children
5. **Automatic logging** = System gets smarter over time
6. **Silent updates** = Profile evolves without teacher effort

---

## The User Experience

Teacher opens app â†’ Sees child tile â†’ Taps "Ask Guru" â†’ Types question â†’ Gets brilliant, specific answer â†’ Moves on with day

All the intelligence is invisible. That's the point.
