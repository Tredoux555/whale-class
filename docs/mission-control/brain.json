{
  "CORE_LAWS": {
    "1_MONTREE_IS_TRUTH": "The /schools/ tree (Montree) is THE source of truth. Everything else is noise.",
    "2_ADMIN_IS_PET": "The /admin/ system is Tredoux's personal sandbox. NOT the product.",
    "3_PORTABLE_BY_DESIGN": "Montree can be cut clean and migrated to any domain at any time.",
    "4_DATABASE_FIRST": "All data lives in Supabase. Frontend just displays it.",
    "5_MULTI_TENANT_ALWAYS": "Every feature must work for ANY school, not just Beijing International."
  },

  "project": "Montree - Multi-tenant Montessori Platform",
  "codename": "Whale (legacy)",
  "lastUpdated": "2026-01-17T00:15:00+08:00",
  "currentSession": "Session 37 FINAL - Teacher Model Defined",
  
  "MONTREE": {
    "definition": "The /schools/ tree - a portable, multi-tenant school management system",
    "rootPath": "/schools/",
    "productionUrl": "https://www.teacherpotato.xyz/schools/",
    "futureUrl": "TBD - will be its own domain when ready",
    "status": "üå± PLANTED - Awaiting Railway deployment"
  },

  "ARCHITECTURE": {
    "hierarchy": [
      "/schools/                              ‚Üí Platform root (all schools)",
      "/schools/[slug]/                       ‚Üí School dashboard",
      "/schools/[slug]/classrooms/            ‚Üí School's classrooms",
      "/schools/[slug]/classrooms/[id]/       ‚Üí Classroom (teachers + students)",
      "/schools/[slug]/classrooms/[id]/login  ‚Üí Teacher login (future)",
      "/schools/[slug]/students/[id]/         ‚Üí Student detail (future)"
    ],
    "key_insight": "School ‚Üí Classroom ‚Üí Teachers (with lead) ‚Üí Students + Works",
    "apiPattern": "/api/schools/[schoolId]/..."
  },

  "TEACHER_MODEL": {
    "principle": "Each classroom has teachers. One is lead. All share student access.",
    "permissions": {
      "all_teachers": ["view_children", "log_progress", "add_notes", "view_works"],
      "lead_only": ["edit_curriculum", "manage_teachers", "change_work_order", "view_audit_log"]
    },
    "authentication": "Each teacher has unique login (name + password)",
    "audit": "Nice-to-have: Log who changed what in progress_audit_log table"
  },

  "WHALE_CLASS_TEAM": {
    "classroom": "Whale Class",
    "school_id": "772b08f1-4e56-4ea6-83b5-21aa8f079b35",
    "teachers": [
      { "name": "Tredoux", "role": "Lead Teacher", "is_lead": true },
      { "name": "Vanessa", "role": "Teacher", "is_lead": false },
      { "name": "Dana", "role": "Teacher", "is_lead": false },
      { "name": "Jenny", "role": "Teacher", "is_lead": false }
    ]
  },

  "DATABASE_SCHEMA": {
    "schools": {
      "purpose": "Tenants",
      "key_fields": ["id", "name", "slug"],
      "status": "‚úÖ exists"
    },
    "classrooms": {
      "purpose": "Classes within schools",
      "key_fields": ["id", "name", "school_id"],
      "status": "‚è≥ needs Whale Class entry"
    },
    "teachers": {
      "purpose": "Teacher accounts",
      "key_fields": ["id", "name", "email", "password_hash"],
      "status": "‚è≥ needs creation"
    },
    "classroom_teachers": {
      "purpose": "Links teachers to classrooms with is_lead flag",
      "key_fields": ["classroom_id", "teacher_id", "school_id", "is_lead"],
      "status": "‚è≥ needs creation"
    },
    "children": {
      "purpose": "Students",
      "key_fields": ["id", "name", "school_id", "classroom_id", "display_order"],
      "status": "‚úÖ exists, needs display_order + classroom_id columns"
    },
    "progress_audit_log": {
      "purpose": "Track who changed what (nice-to-have)",
      "key_fields": ["child_id", "teacher_id", "action", "old_value", "new_value"],
      "status": "‚è≥ future"
    }
  },

  "FIRST_TENANT": {
    "name": "Beijing International School",
    "slug": "beijing-international",
    "id": "772b08f1-4e56-4ea6-83b5-21aa8f079b35",
    "classroom": "Whale Class",
    "students": 18,
    "student_order": [
      "Rachel", "Yueze", "Lucky", "Austin", "Minxi", "Leo",
      "Joey", "Eric", "Jimmy", "Kevin", "Niuniu", "Amy",
      "Henry", "Segina", "Hayden", "KK", "Kayla", "Stella"
    ]
  },

  "LEGACY_ADMIN": {
    "status": "PET PROJECT - SEPARATE FROM MONTREE",
    "path": "/admin/",
    "note": "Do not connect admin features to Montree. They are different systems."
  },

  "NEXT_SESSION_PRIORITIES": [
    "1. Check if /schools/ routes deployed (Railway may have caught up)",
    "2. Run student display_order SQLs",
    "3. Create teachers + classroom_teachers tables",
    "4. Insert Whale Class teachers (Tredoux lead, Vanessa/Dana/Jenny)",
    "5. Build teacher login at /schools/[slug]/classrooms/[id]/login",
    "6. Implement is_lead permission checks"
  ],

  "SESSION_PROTOCOL": {
    "1_READ_BRAIN": "Always read this file first",
    "2_READ_HANDOFF": "Check HANDOFF_JAN17_SESSION37_FINAL.md",
    "3_MONTREE_FIRST": "Work on /schools/ tree, not /admin/",
    "4_DATABASE_CHANGES": "Document all schema changes",
    "5_HANDOFF_ALWAYS": "Write handoff at session end"
  }
}
